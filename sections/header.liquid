<header class="site-header" data-sticky="true">
  <div class="header-top">
    <div class="container header-content">
      <div class="header-logo">
        <a href="{{ routes.root_url }}" class="logo-link">
          {% if shop.brand.logo %}
            <img src="{{ shop.brand.logo | image_url: width: 250 }}" alt="{{ shop.name }}" class="logo-img" loading="eager" width="250" height="50">
          {% else %}
            <span class="logo-text">{{ shop.name }}</span>
          {% endif %}
        </a>
      </div>

      <nav class="header-nav" role="navigation" aria-label="Primary Navigation">
        <ul class="nav-list">
          {% for link in linklists.main-menu.links %}
            <li class="nav-item">
              <a href="{{ link.url }}" class="nav-link {% if link.active %}active{% endif %}">
                {{ link.title }}
                {% if link.links.size > 0 %}
                  <span class="dropdown-indicator">â–¼</span>
                {% endif %}
              </a>
              {% if link.links.size > 0 %}
                <ul class="dropdown-menu">
                  {% for childlink in link.links %}
                    <li><a href="{{ childlink.url }}">{{ childlink.title }}</a></li>
                  {% endfor %}
                </ul>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      </nav>

      <div class="header-actions">
        {% render 'search-box' %}
        <a href="{{ routes.cart_url }}" class="cart-link" aria-label="Cart">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
          </svg>
          <span class="cart-count" id="cart-count">{{ cart.item_count }}</span>
        </a>
        {% if customer %}
          <a href="{{ routes.account_url }}" class="account-link" aria-label="Account">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
          </a>
        {% else %}
          <a href="{{ routes.account_login_url }}" class="login-link">Sign In</a>
        {% endif %}
      </div>

      <button class="mobile-nav-toggle" id="mobile-nav-toggle" aria-label="Menu">
        <span></span><span></span><span></span>
      </button>
    </div>
  </div>

  {% if settings.show_announcement %}
    <div class="announcement-bar">
      <p>{{ settings.announcement_text }}</p>
    </div>
  {% endif %}
</header>

{% stylesheet %}
  .site-header {
    background-color: var(--color-background);
    border-bottom: 1px solid var(--color-border);
    position: sticky;
    top: 0;
    z-index: 100;
  }

  .header-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 2rem;
    padding: 1rem var(--spacing-base);
  }

  .header-logo { flex-shrink: 0; }
  .logo-img { max-height: 50px; }
  .logo-text { font-weight: 700; font-size: 1.5rem; }

  .header-nav { flex: 1; }
  .nav-list { list-style: none; margin: 0; padding: 0; display: flex; gap: 2rem; }
  .nav-link { color: var(--color-text); font-weight: 500; position: relative; }
  .nav-link:hover { color: var(--color-primary); }

  .dropdown-menu {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    background: white;
    border: 1px solid var(--color-border);
    border-radius: 4px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    list-style: none;
    padding: 0.5rem 0;
    min-width: 200px;
  }

  .nav-item:hover .dropdown-menu { display: block; }
  .dropdown-menu li { margin: 0; }
  .dropdown-menu a { display: block; padding: 0.5rem 1.5rem; }
  .dropdown-menu a:hover { color: var(--color-primary); }

  .header-actions {
    display: flex;
    align-items: center;
    gap: 1.5rem;
  }

  .cart-link, .account-link, .login-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .cart-count {
    background: var(--color-primary);
    color: white;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    font-weight: 700;
  }

  .mobile-nav-toggle { display: none; background: none; border: none; font-size: 1.5rem; }

  @media (max-width: 768px) {
    .header-nav { display: none; }
    .mobile-nav-toggle { display: block; }
    .header-content { gap: 1rem; }
    .nav-list { flex-direction: column; gap: 0; }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_announcement",
      "label": "Show announcement bar",
      "default": false
    },
    {
      "type": "text",
      "id": "announcement_text",
      "label": "Announcement text",
      "default": "Free shipping on orders over $50"
    }
  ]
}
{% endschema %}
